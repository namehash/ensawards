---
import type { UnixTimestamp } from "@ensnode/ensnode-sdk";
import { secondsInDay } from "date-fns/constants";
import { cn } from "../../utils/tailwindClassConcatenation";

interface AlertCountdownProps {
  eventUnixTimestamp: UnixTimestamp;
  eventText: string;
  ctaText?: string;
  link?: string;
  styles?: {
    banner?: string;
    cta?: string;
    text?: string;
    timer?: string;
    timerLegend?: string;
  };
}

const { eventUnixTimestamp, eventText, ctaText, link, styles }: AlertCountdownProps = Astro.props;
---

<a
  href={link}
  id="countdownAlertRoot"
  data-timestamp={eventUnixTimestamp}
  data-threshold={90 * secondsInDay}
  style={{ display: "none" }}
  class={cn(
    "w-full h-[44px] box-border flex flex-row justify-center gap-2 sm:gap-5 items-center px-4 py-3 cursor-default",
    styles?.banner,
    link !== undefined && "cursor-pointer",
  )}>
  <div class="flex flex-row flex-nowrap justify-start items-center gap-3">
    <div class="flex flex-row justify-start items-center gap-1.5">
      <p
        class={cn(
          "text-sm leading-5 sm:leading-normal font-normal max-sm:text-center",
          styles?.text,
        )}>
        {eventText}
      </p>
    </div>
  </div>
  <div
    id="timerWrapper"
    style={{ display: "none" }}
    class="h-8 box-border flex flex-row flex-nowrap justify-start items-center gap-3 px-3 py-1 rounded-full bg-black/10">
    <div class="w-fit flex flex-row justify-center items-center gap-1">
      <p
        id="daysLeft"
        class={cn("text-base leading-normal font-medium", styles?.timer)}>
      </p>
      <p
        class={cn("text-base leading-normal font-medium", styles?.timerLegend)}>
        days
      </p>
    </div>
    <div class={cn("w-[1px] h-[24px] bg-white/20")}></div>
    <div class="w-fit flex flex-row justify-center items-center gap-1">
      <p
        id="hoursLeft"
        class={cn("text-base leading-normal font-medium", styles?.timer)}>
      </p>
      <p
        class={cn("text-base leading-normal font-medium", styles?.timerLegend)}>
        hours
      </p>
    </div>
    <div class={cn("w-[1px] h-[24px] bg-white/20")}></div>
    <div class="w-fit flex flex-row justify-center items-center gap-1">
      <p
        id="minutesLeft"
        class={cn("text-base leading-normal font-medium", styles?.timer)}>
      </p>
      <p
        class={cn("text-base leading-normal font-medium", styles?.timerLegend)}>
        minutes
      </p>
    </div>
  </div>
  <div
    id="mobileTimerWrapper"
    style={{ display: "none" }}
    class="h-[28px] w-fit box-border flex flex-row flex-nowrap justify-center items-center gap-1 px-3 py-1 rounded-full bg-black/10">
    <p
      id="unitsLeft"
      class={cn("text-sm leading-normal font-medium", styles?.timer)}>
    </p>
  </div>
  {
    ctaText && (
      <p
        class={cn(
          "hidden sm:block text-sm leading-normal font-semibold underline underline-offset-[25%] transition-all duration-200 cursor-pointer",
          styles?.cta,
        )}>
        {ctaText}
      </p>
    )
  }
</a>