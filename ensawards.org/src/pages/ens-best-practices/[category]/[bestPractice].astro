---
import AppBestPracticeDetails from "../../../components/organisms/AppBestPracticeDetails.astro";
import DataLoadingError from "../../../components/organisms/DataLoadingError.astro";
import ProtocolBestPracticeDetails from "../../../components/organisms/ProtocolBestPracticeDetails.astro";
import Layout from "../../../layouts/Layout.astro";
import { BestPracticeTypes } from "../../../types/bestPractices";
import { getBestPracticeBySlug } from "../../../utils/dataAccess";
import TechnicalInfoAnchorScript from "../../../components/atoms/TechnicalInfoAnchorScript.astro";
import { BEST_PRACTICE_CATEGORIES } from "../../../data/ens-best-practices/categories";
export function getStaticPaths() {
  const staticPaths = [];

  for (let category of BEST_PRACTICE_CATEGORIES) {
    category.bestPractices.forEach((bestPractice) =>
      staticPaths.push({
        params: { category: category.slug, bestPractice: bestPractice.slug },
      }),
    );
  }
  return staticPaths;
}

const { category, bestPractice } = Astro.params;

const bestPracticeToDisplay = getBestPracticeBySlug(bestPractice);
---

{
  bestPracticeToDisplay === undefined ? (
    // theoretically, because of Astro's build-time page generation, this should never happen
    <DataLoadingError />
  ) : (
    <Layout
      pageMetadata={{
        title: `ENSAwards: ${bestPracticeToDisplay.name}`,
        description: bestPracticeToDisplay.description,
        url: `https://ensawards.org/ens-best-practices/${bestPracticeToDisplay.categorySlug}/${bestPracticeToDisplay.slug}`,
      }}>
      {bestPracticeToDisplay.type === BestPracticeTypes.App ? (
        <AppBestPracticeDetails bestPractice={bestPracticeToDisplay} />
      ) : (
        <ProtocolBestPracticeDetails bestPractice={bestPracticeToDisplay} />
      )}
      <TechnicalInfoAnchorScript />
    </Layout>
  )
}
